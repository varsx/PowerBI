<center>
#Power-BI（1）
</center>
<p style="text-indent:2em">上节课，老师讲到了Power-BI的五种常见功——CSVCS，他们分别是，整理数据源、雕刻数据、可视化数据、制作数据报表和共享数据成果。这门课我们最终要学会五十多张图表的制作，下面是我们做的第一个图的预览效果。</p>
![](1.png)

##整理数据源（Collating data resoure)
<p style="text-indent:2em">
首先，在将数据导入到Power-BI之前，我们得先检查一遍数据有没有问题。因为Power-BI支持线上（online）和线下（local）的两种模式。所以我们在导入线上数据的时候，要确保我们的电脑的网络能打开该网站。比如我们想画一个显示每届亚运会举办地点的地图，每届亚运会举办地点的表格可以在网上抓取。地址如下：
<br>
[亚运会](https://baike.baidu.com/item/%E4%BA%9A%E6%B4%B2%E8%BF%90%E5%8A%A8%E4%BC%9A/2753926?fromtitle=%E4%BA%9A%E8%BF%90%E4%BC%9A&fromid=343628&fr=aladdin)
</p>
<p style="text-indent:2em">
在导入数据之前，我们先打开上述网站，保证我们的设备可以进入。接下来我们就可以将数据表格导入进Power-BI中。如下图，Power-BI导入数据集的方式有很多，我们选择第一个方框中的<font color=#FF0000 size=3 face="黑体">“获取数据”<font color=#000000 size=3 face="黑体">。
</p>
![](2.png)
<p style="text-indent:2em">
进入获取界面后，我们要抓取网上的数据。所以选择<font color=#FF0000 size=3 face="黑体">“其他类”<font color=#000000 size=3 face="黑体">。
</p>
![](3.png)
<p style="text-indent:2em">
“其它类”中，第一个<font color=#FF0000 size=3 face="黑体">“Web”<font color=#000000 size=3 face="黑体">，点击“连接”。
</p>
![](4.png)
<p style="text-indent:2em">
进入后，我们将之前找到的亚运会网址输入，点击“确定”。
</p>
![](5.png)
<p style="text-indent:2em">
片刻之后，会进入一个“导航器”的界面（网不好的话可能久一点）。这个操作会将该网站中的表格和“像表格的”都导入进“导航器”中，我们可以在“导航器”中预览这些表格和“像表格的”，然后从中挑选出我们需要的表格，点击“加载”。
</p>
![](6.png)
<p style="text-indent:2em">
然后，我们导入成功！
</p>
![](7.png)
##雕刻数据（Sculpting data)
<p style="text-indent:2em">
在画图之前，因为表格里面有很多冗余的数据，所以我们得先对表格进行预处理。我们可以点击如下图所示位置预览表格。（注：处理表格前预览一遍是好习惯!）
</p>
![](8.png)
<p style="text-indent:2em">
预览完成后，然后我们回到之前的界面，右击我们处理的目标，点击“编辑查询”。
</p>
![](9.png)
<p style="text-indent:2em">
然后我们就进入这个界面，当然这个界面也可以预览表格，也可以通过左边的“查询”切换表格。（这里没有圈出来）
</p>
<p style="text-indent:2em">

根据下图，我们进行操作。我们双击“column”就可以进行改名。例如：双击“column1”，修改为届次。然后可以拖动下面的滑条，将所有的“column”都进行修改。然后再点击“删除行”。
</p>
![](10.png)
<p style="text-indent:2em">
点击“删除行”后，我们要删除前两行，所以输入2.然后点击“确定”。同时，我们可以将最后一行没用的数据删除，方法同理。
</p>
![](11.png)
<p style="text-indent:2em">
确认修改无误后，点击右上角的×退出。
</p>
![](12.png)
<p style="text-indent:2em">
然后点“是”，就会自动保存我们之前所做的修改。
</p>
![](13.png)
<p style="text-indent:2em">
可以看到，“字段”这里的类别名称已经修改完成。如果想把“表1（2）”修改，可以右击，然后选择重命名。这里就不演示了。
</p>
![](14.png)
##可视化数据（Visualizing data)
<p style="text-indent:2em">
经过前两步的处理，接下来我就可以正式作图了。首先，我们希望做出显示亚运会中各届举办地点的地图。因此，我们应该点击“可视化”这栏中的地球状图形，然后将所得到的图像拉大。然后再从“字段”中提前想好我们要显示的变量，可以是“举办城市”或者“举办国家”。下面就以“举办国家”为例。
</p>
![](15.png)
<p style="text-indent:2em">
然后，我们可以看到“可视化”一栏中多出了很多选项。我们将“举办国家”拖到“位置”一栏，就可以在地图上看到一些蓝色的点点，将亚运会不同届举办的地点标注出来了。
</p>
![](16.png)
<p style="text-indent:2em">
但是我们希望不同的国家用<font color=#FF0000 size=3 face="黑体">不同的颜色<font color=#000000 size=3 face="黑体">标注出来，这种方法就需要用到“图例”。具体操作就是，将“举办国家”拖入“图例”中。
</p>
<p style="text-indent:2em">
简单介绍一下“图例”的作用，在一个二维图中，我们要画y-x的图像（想象一下高中的画图），这时候我们希望把不同的函数在同一图上表示出来，就需要用到“图例”。举个例子，我们想将y=x和y=sinx这两个函数在图中表示，y=x用红色的实线，y=sinx用蓝色的虚线，然后在画出的图中的空白处，我们注释y=x“<font color=#FF0000 size=3 face="黑体">——<font color=#000000 size=3 face="黑体">”，y=sinx“<font color=#0000FF size=3 face="黑体">---<font color=#000000 size=3 face="黑体">”。
</p>![](18.png)

<p style="text-indent:2em">
不过我们发现还不够完美，因为亚运会在某些国家不止举办了一场，而图中的信息似乎不能体现这一点。所以，我们希望画出的点点的大小能够代表该国家举办亚运会的举办届次。例如：“伊朗”举办了一次，我们希望表示举办地点在“伊朗”的圈圈保持原样，“泰国”举办了四次，我们希望表示举办地点在“泰国”的圈圈大一点。
</p>
<p style="text-indent:2em">
这里我们就要用到“大小”，我们将“举办国家”拖到“大小”一栏，就会发现自动帮我们进行计数，结果如我们预期。如下图。
</p>
![](19.png)
<p style="text-indent:2em">
接下来，我们希望在地图上显示出每个点代表哪个国家，这样更加方便我们观看，而不是对着图例一个个寻找该颜色代表哪个国家。这里我们可以点击可视化中长得像刷子的图标，它的名字是“格式”，然后将下面的“类别标签”打开，就可以在地图上显示国家的名字了。
</p>
![](20.png)
##补充
<p style="text-indent:2em">
对于老师提出的如何在图中更加详细的表示出大小的问题。笔者认为，这就看能不能理解“图例”的作用，之前我们的“图例”中放如入的“举办国家”，所以就按照了不同的“举办国家”标注了不同的颜色，如果我们将这里改为“举办时间”或者“届次”或者“赛事名称”，就会发现，我们很容易观察出来某些国家到底举办了多少场。
</p>
![](21.png)
<p style="text-indent:2em">
然后，有些时候我们会发现明明操作了，但是图还是没有显示，这可能是雕刻数据的时候数据还没有完全更新过来（个人猜测是网速太慢了）。这时候我们可以预览一下数据有没有加载完成或者还有没有其它纰漏。如果预览的时候发现表格没有加载出来，按照图示方法刷新一下。
</p>
![](22.png)


